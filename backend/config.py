"""
–ú–æ–¥—É–ª—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∑–∞–≥—Ä—É–∑–∫—É –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è.
–ó–¥–µ—Å—å —Ö—Ä–∞–Ω—è—Ç—Å—è API –∫–ª—é—á–∏, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏ –¥—Ä—É–≥–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
"""

import os
from dotenv import load_dotenv

# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ —Ñ–∞–π–ª–∞ .env
# –§–∞–π–ª .env –¥–æ–ª–∂–µ–Ω –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å:
# YANDEX_API_KEY=–≤–∞—à_–∫–ª—é—á
# YANDEX_FOLDER_ID=–≤–∞—à_folder_id
load_dotenv()


class Settings:
    """
    –ö–ª–∞—Å—Å –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
    
    –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env —Ñ–∞–π–ª).
    –≠—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–± —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–µ–∫—Ä–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (API –∫–ª—é—á–∏).
    """
    
    # ========== Yandex Cloud AI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ ==========
    # API –∫–ª—é—á –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ YandexGPT
    # –ü–æ–ª—É—á–∏—Ç—å –º–æ–∂–Ω–æ –Ω–∞: https://cloud.yandex.ru/
    # IAM ‚Üí –°–µ—Ä–≤–∏—Å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã ‚Üí –°–æ–∑–¥–∞—Ç—å ‚Üí API –∫–ª—é—á
    YANDEX_API_KEY: str = os.getenv("YANDEX_API_KEY", "")
    
    # Folder ID - –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–∞–ª–æ–≥–∞ –≤ Yandex Cloud
    # –ú–æ–∂–Ω–æ –Ω–∞–π—Ç–∏ –≤ URL –∫–∞—Ç–∞–ª–æ–≥–∞ –∏–ª–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
    YANDEX_FOLDER_ID: str = os.getenv("YANDEX_FOLDER_ID", "")
    
    # URL –¥–ª—è API YandexGPT
    # –≠—Ç–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç, –∫ –∫–æ—Ç–æ—Ä–æ–º—É –º—ã –±—É–¥–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–ø—Ä–æ—Å—ã
    YANDEX_API_URL: str = "https://llm.api.cloud.yandex.net/foundationModels/v1/completion"
    
    # ========== –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö ==========
    # URL –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
    # SQLite - –ø—Ä–æ—Å—Ç–∞—è —Ñ–∞–π–ª–æ–≤–∞—è –ë–î, –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
    # –§–∞–π–ª letters.db –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
    DATABASE_URL: str = os.getenv("DATABASE_URL", "sqlite:///./letters.db")
    
    # ========== –°–µ—Ä–≤–µ—Ä ==========
    # –•–æ—Å—Ç –∏ –ø–æ—Ä—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ FastAPI —Å–µ—Ä–≤–µ—Ä–∞
    HOST: str = os.getenv("HOST", "0.0.0.0")  # 0.0.0.0 –æ–∑–Ω–∞—á–∞–µ—Ç "—Å–ª—É—à–∞—Ç—å –Ω–∞ –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞—Ö"
    PORT: int = int(os.getenv("PORT", "8000"))
    
    # ========== –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —É—Å–ª—É–≥ ==========
    # –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π –±–∞–Ω–∫–æ–≤—Å–∫–∏—Ö —É—Å–ª—É–≥
    # –ö–∞–∂–¥—ã–π —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –≤—ã–±–∏—Ä–∞–µ—Ç –æ–¥–Ω—É –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
    # –ü–∏—Å—å–º–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É—é—Ç—Å—è –ø–æ —ç—Ç–∏–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –∏ –Ω–∞–ø—Ä–∞–≤–ª—è—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º
    BANK_CATEGORIES = [
        "credit",           # –û—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ –∫—Ä–µ–¥–∏—Ç–æ–≤
        "deposit",          # –í–∫–ª–∞–¥—ã –∏ –¥–µ–ø–æ–∑–∏—Ç—ã
        "insurance",        # –°—Ç—Ä–∞—Ö–æ–≤–∞–Ω–∏–µ (–û–°–ê–ì–û, –ö–ê–°–ö–û –∏ —Ç.–¥.)
        "cards",            # –ë–∞–Ω–∫–æ–≤—Å–∫–∏–µ –∫–∞—Ä—Ç—ã
        "mortgage",         # –ò–ø–æ—Ç–µ–∫–∞
        "business",         # –ë–∏–∑–Ω–µ—Å-—É—Å–ª—É–≥–∏
        "investment",       # –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏
        "online_banking",   # –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-–±–∞–Ω–∫–∏–Ω–≥
        "currency",         # –í–∞–ª—é—Ç–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
        "other"             # –ü—Ä–æ—á–µ–µ
    ]
    
    # ========== –°—Ç–∞—Ç—É—Å—ã –ø–∏—Å–µ–º ==========
    # –°—Ç–∞—Ç—É—Å—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –ø–∏—Å—å–º–æ –≤ —Å–∏—Å—Ç–µ–º–µ
    LETTER_STATUSES = {
        "waiting": "–û–∂–∏–¥–∞–Ω–∏–µ",        # –ü–∏—Å—å–º–æ —Å–æ–∑–¥–∞–Ω–æ, –Ω–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –µ—â–µ –Ω–µ –æ—Ç–∫—Ä—ã–ª
        "in_progress": "–í —Ä–∞–±–æ—Ç–µ",     # –°–æ—Ç—Ä—É–¥–Ω–∏–∫ –æ—Ç–∫—Ä—ã–ª –ø–∏—Å—å–º–æ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞–¥ –æ—Ç–≤–µ—Ç–æ–º
        "sent": "–û—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ",         # –û—Ç–≤–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        "closed": "–ó–∞–∫—Ä—ã—Ç–æ"           # –ü–∏—Å—å–º–æ –∑–∞–∫—Ä—ã—Ç–æ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
    }
    
    # ========== –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã ==========
    # USE_MOCK_AI = True - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫-–≤–µ—Ä—Å–∏—é Yandex AI (–¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ API)
    # USE_MOCK_AI = False - –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–π Yandex AI API
    USE_MOCK_AI: bool = os.getenv("USE_MOCK_AI", "True").lower() == "true"


# –°–æ–∑–¥–∞–µ–º –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞—Å—Ç—Ä–æ–µ–∫
# –≠—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω Singleton - –≤—Å–µ —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç settings
settings = Settings()


def validate_settings():
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –≤—Å–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã.
    
    –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —á—Ç–æ–±—ã —É–±–µ–¥–∏—Ç—å—Å—è,
    —á—Ç–æ API –∫–ª—é—á–∏ –∏ –¥—Ä—É–≥–∏–µ –≤–∞–∂–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.
    
    –í –º–æ–∫-—Ä–µ–∂–∏–º–µ (USE_MOCK_AI=True) –ø—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–µ–π –Ω–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è.
    
    Raises:
        ValueError: –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    """
    # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–∫-—Ä–µ–∂–∏–º, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É API –∫–ª—é—á–µ–π
    if settings.USE_MOCK_AI:
        print("üîß –ú–æ–∫-—Ä–µ–∂–∏–º –≤–∫–ª—é—á–µ–Ω: –ø—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–µ–π –ø—Ä–æ–ø—É—â–µ–Ω–∞")
        print("‚úÖ –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")
        return
    
    # –í –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–æ–≤–µ—Ä—è–µ–º API –∫–ª—é—á–∏
    if not settings.YANDEX_API_KEY:
        raise ValueError("YANDEX_API_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env —Ñ–∞–π–ª–µ!")
    
    if not settings.YANDEX_FOLDER_ID:
        raise ValueError("YANDEX_FOLDER_ID –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ .env —Ñ–∞–π–ª–µ!")
    
    print("‚úÖ –í—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!")

