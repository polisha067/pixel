"""
Универсальный агент для генерации ответов.

Используется для категорий, для которых нет специализированного агента,
или для категории "other" (прочее).

Стиль: универсальный деловой, профессиональный, клиентоориентированный.
"""

from backend.agents.base_agent import BaseAgent
from backend.services.yandex_ai import send_request_to_yandex


class GeneralAgent(BaseAgent):
    """
    Универсальный агент для общих запросов.
    
    Генерирует ответы в универсальном деловом стиле,
    подходящем для любых ситуаций.
    """
    
    def __init__(self):
        system_instruction = """Ты - специалист банка по работе с клиентами.
Твоя задача - отвечать на обращения клиентов в профессиональном стиле.

Стиль ответа:
- Деловой и профессиональный
- Вежливый и уважительный
- Клиентоориентированный
- Информативный

Обязательно:
- Поблагодарить за обращение
- Предложить конкретные шаги для решения вопроса
- Предложить связаться для дополнительной консультации
- Использовать корпоративный стиль банка
- Быть вежливым и готовым помочь"""
        
        super().__init__(
            name="General Agent",
            system_instruction=system_instruction
        )
    
    def generate_response(self, letter_text: str) -> str:
        """
        Генерирует универсальный ответ на письмо.
        
        Args:
            letter_text: Текст входящего письма
        
        Returns:
            str: Сгенерированный ответ
        """
        additional_instructions = """
Проанализируй запрос клиента и предложи наиболее подходящее решение.
Если вопрос требует уточнения - предложи связаться для консультации.
Будь готовым помочь и решить вопрос клиента."""
        
        prompt = self._build_prompt(letter_text, additional_instructions)
        response = send_request_to_yandex(prompt, temperature=0.7)
        
        return response

