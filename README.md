# Банковская система обработки писем

Веб-система для обработки писем клиентов банка с использованием Yandex Cloud AI.

## Функциональность

### Для клиентов банка:
- Регистрация и авторизация
- Отправка писем в банк
- Просмотр статуса своих писем
- Одобрение ответов от сотрудников банка

### Для сотрудников банка:
- Регистрация и авторизация
- Просмотр всех писем от клиентов
- Взятие писем в работу
- Автоматическая генерация ответов через нейронную сеть
- Просмотр статистики завершенных писем

### Технические особенности:
- База данных SQLite с SQLAlchemy
- Простая система сессий для авторизации
- Автоматический анализ типа письма
- Генерация профессиональных ответов через Yandex Cloud AI

## Запуск

### Вариант 1: Через Docker (Рекомендуется)

#### 1. Установите Docker и Docker Compose

#### 2. Настройте переменные окружения

Скопируйте файл с примером и заполните свои ключи:
```bash
cp env.example .env
```

Или на Windows:
```cmd
copy env.example .env
```

Отредактируйте `.env` файл, вставив свои ключи Yandex Cloud:
```
api_key=ваш_api_ключ_здесь
folder_id=ваш_folder_id_здесь
```

#### 3. Запустите проект

**Windows:**
```cmd
start-docker.bat
```

**Linux/Mac:**
```bash
docker-compose up --build
```

Проект будет доступен по адресу:
- **Веб-сайт**: http://localhost:8001 (откроется HTML страница)
- **Backend API**: http://localhost:8001/mail_generator (POST запрос)

#### 4. Остановка
```bash
docker-compose down
```

### Вариант 2: Локальный запуск (без Docker)

#### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

#### 2. Настройка переменных окружения

Создайте файл `.env` в корневой папке со следующими переменными:

```
api_key=ваш_api_ключ_yandex_cloud
folder_id=ваш_folder_id_yandex_cloud
```

#### 3. Запуск серверов

**Windows (автоматический запуск):**
```cmd
start.bat
```

**Linux/Mac (ручной запуск):**

##### Backend (FastAPI)
```bash
cd backend
python main.py
```

Сервер запустится на http://localhost:8001

**Откройте в браузере:** http://localhost:8001

> **Примечание:** Frontend теперь встроен в FastAPI, отдельный сервер для frontend не нужен!

## Использование

### Для клиентов:
1. Откройте браузер и перейдите на http://localhost:8001
2. Нажмите "Зарегистрироваться" в разделе "Клиент банка"
3. Заполните форму регистрации и войдите в систему
4. На странице панели клиента отправьте письмо
5. Отслеживайте статус письма и одобряйте готовые ответы

### Для сотрудников:
1. Откройте браузер и перейдите на http://localhost:8001
2. Нажмите "Зарегистрироваться" в разделе "Сотрудник банка"
3. Заполните форму регистрации и войдите в систему
4. На странице панели сотрудника просматривайте все письма
5. Берите письма в работу и обрабатывайте их (генерация ответа через AI)
6. Просматривайте статистику завершенных писем

## Архитектура

- **Backend**: FastAPI с интеграцией Yandex Cloud AI
- **Frontend**: HTML, CSS, JavaScript (без фреймворков)
- **База данных**: SQLite с SQLAlchemy ORM
- **Авторизация**: Простая система сессий (в заголовках)
- **AI**: Yandex Cloud Qwen3-235B модель для анализа и генерации текста

## Структура базы данных

- **Users**: Пользователи (клиенты и сотрудники)
- **Letters**: Письма с статусами (pending, in_work, response_ready, completed)